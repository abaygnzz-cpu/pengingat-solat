<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Penghitung Kalori Harian</title>
<style>
  body {
    font-family: "Poppins", sans-serif;
    background: #f4f6f8;
    margin: 0;
    padding: 0;
    color: #222;
  }
  header {
    background: #2563eb;
    color: white;
    text-align: center;
    padding: 1rem;
    font-size: 1.5rem;
    font-weight: bold;
  }
  .container {
    max-width: 900px;
    margin: 2rem auto;
    background: white;
    border-radius: 1rem;
    padding: 1.5rem;
    box-shadow: 0 4px 12px rgba(0,0,0,0.1);
  }
  input, select, button {
    width: 100%;
    padding: 0.7rem;
    border: 1px solid #ccc;
    border-radius: 0.5rem;
    font-size: 1rem;
  }
  button {
    background: #2563eb;
    color: white;
    border: none;
    cursor: pointer;
    transition: 0.2s;
  }
  button:hover { background: #1e40af; }
  .row { display: flex; gap: 0.5rem; flex-wrap: wrap; }
  .row > * { flex: 1; }
  .summary {
    background: #f9fafb;
    padding: 1rem;
    border-radius: 0.5rem;
    margin-top: 1rem;
  }
  table {
    width: 100%;
    border-collapse: collapse;
    margin-top: 1rem;
  }
  th, td {
    padding: 0.6rem;
    border-bottom: 1px solid #eee;
  }
  .delete {
    color: #ef4444;
    cursor: pointer;
  }
  #chart { margin-top: 1.5rem; }
</style>
</head>
<body>
<header>üçΩÔ∏è Penghitung Kalori Harian</header>
<div class="container">
  <div class="row">
    <input type="text" id="searchFood" placeholder="Cari makanan (contoh: ayam bakar, pasta)">
    <datalist id="foodList"></datalist>
  </div>
  <div class="row">
    <input type="number" id="foodWeight" placeholder="Berat (gram)">
    <button id="addFood">Tambah</button>
  </div>
  <div class="row">
    <input type="number" id="calNeed" placeholder="Kebutuhan kalori harian (kcal)" value="2000">
    <select id="goal">
      <option value="maintain">Pertahankan berat</option>
      <option value="deficit">Defisit kalori (turun berat)</option>
      <option value="surplus">Surplus kalori (naik berat)</option>
    </select>
  </div>
  <div class="summary">
    <p><strong>Total Kalori:</strong> <span id="totalCal">0</span> kcal</p>
    <p><strong>Total Protein:</strong> <span id="totalProtein">0</span> g</p>
    <p><strong>Sisa Kalori:</strong> <span id="remainingCal">0</span> kcal</p>
  </div>

  <table>
    <thead><tr><th>Makanan</th><th>Kalori</th><th>Protein</th><th>Aksi</th></tr></thead>
    <tbody id="foodTable"></tbody>
  </table>

  <canvas id="chart" height="200"></canvas>
</div>

<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script>
const foodData = {
  // üåæ Makanan pokok
  "nasi putih": { cal: 130, protein: 2.5 },
  "nasi goreng": { cal: 250, protein: 6 },
  "nasi uduk": { cal: 450, protein: 10 },
  "nasi padang": { cal: 600, protein: 25 },
  "mie goreng": { cal: 300, protein: 8 },
  "mie rebus": { cal: 280, protein: 7 },
  "spaghetti bolognese": { cal: 350, protein: 15 },
  "pasta carbonara": { cal: 370, protein: 14 },
  "lasagna": { cal: 400, protein: 18 },
  "kentang rebus": { cal: 87, protein: 2 },
  "kentang goreng": { cal: 312, protein: 3.5 },
  "roti tawar": { cal: 90, protein: 3 },
  "roti isi cokelat": { cal: 250, protein: 5 },
  "bubur ayam": { cal: 150, protein: 9 },

  // üçó Ayam dan daging
  "ayam goreng": { cal: 260, protein: 25 },
  "ayam bakar": { cal: 200, protein: 27 },
  "ayam rebus": { cal: 170, protein: 31 },
  "sate ayam": { cal: 270, protein: 25 },
  "sate kambing": { cal: 300, protein: 22 },
  "rendang": { cal: 250, protein: 21 },
  "daging sapi goreng": { cal: 270, protein: 26 },
  "daging sapi rebus": { cal: 180, protein: 29 },
  "daging cincang": { cal: 220, protein: 20 },
  "bakso sapi": { cal: 150, protein: 10 },
  "sosis ayam": { cal: 200, protein: 12 },
  "nugget ayam": { cal: 290, protein: 14 },
  "ayam crispy": { cal: 320, protein: 19 },

  // üêü Ikan dan seafood
  "ikan goreng": { cal: 220, protein: 23 },
  "ikan bakar": { cal: 180, protein: 22 },
  "ikan tuna": { cal: 132, protein: 28 },
  "ikan salmon": { cal: 206, protein: 22 },
  "cumi goreng": { cal: 175, protein: 16 },
  "udang goreng": { cal: 200, protein: 18 },
  "udang rebus": { cal: 99, protein: 24 },

  // üå± Sayur dan lauk nabati
  "tempe goreng": { cal: 190, protein: 10 },
  "tahu goreng": { cal: 150, protein: 8 },
  "sayur asem": { cal: 70, protein: 3 },
  "sayur lodeh": { cal: 120, protein: 4 },
  "gado-gado": { cal: 220, protein: 9 },
  "pecel": { cal: 180, protein: 7 },
  "capcay": { cal: 110, protein: 5 },
  "sup sayur": { cal: 80, protein: 3 },

  // üçé Buah-buahan
  "pisang": { cal: 89, protein: 1 },
  "apel": { cal: 52, protein: 0.3 },
  "jeruk": { cal: 47, protein: 0.9 },
  "mangga": { cal: 60, protein: 0.8 },
  "alpukat": { cal: 160, protein: 2 },
  "semangka": { cal: 30, protein: 0.6 },
  "pepaya": { cal: 43, protein: 0.5 },
  "nanas": { cal: 50, protein: 0.5 },

  // üç© Snack & minuman
  "kerupuk": { cal: 100, protein: 1 },
  "kentang chips": { cal: 536, protein: 7 },
  "donat": { cal: 250, protein: 4 },
  "martabak manis": { cal: 380, protein: 6 },
  "martabak telur": { cal: 450, protein: 20 },
  "es teh manis": { cal: 90, protein: 0 },
  "kopi susu": { cal: 110, protein: 3 },
  "susu full cream": { cal: 150, protein: 8 },
  "jus jeruk": { cal: 85, protein: 1 },
  "jus alpukat": { cal: 160, protein: 2 },
  "air mineral": { cal: 0, protein: 0 }
};

let foods = JSON.parse(localStorage.getItem("foods") || "[]");
let calNeed = localStorage.getItem("calNeed") || 2000;
let goal = localStorage.getItem("goal") || "maintain";
let chart;

function updateList() {
  const tbody = document.getElementById("foodTable");
  tbody.innerHTML = "";
  let totalCal = 0, totalProtein = 0;
  foods.forEach((f, i) => {
    totalCal += f.cal;
    totalProtein += f.protein;
    const tr = document.createElement("tr");
    tr.innerHTML = `<td>${f.name}</td><td>${f.cal.toFixed(1)}</td><td>${f.protein.toFixed(1)}</td><td><span class="delete" onclick="deleteFood(${i})">üóëÔ∏è</span></td>`;
    tbody.appendChild(tr);
  });

  const adjust = goal === "deficit" ? -300 : goal === "surplus" ? 300 : 0;
  const remaining = (parseFloat(calNeed) + adjust) - totalCal;
  document.getElementById("totalCal").textContent = totalCal.toFixed(1);
  document.getElementById("totalProtein").textContent = totalProtein.toFixed(1);
  document.getElementById("remainingCal").textContent = remaining.toFixed(1);

  localStorage.setItem("foods", JSON.stringify(foods));
  localStorage.setItem("calNeed", calNeed);
  localStorage.setItem("goal", goal);

  updateChart(totalCal, remaining);
}

function updateChart(totalCal, remaining) {
  const ctx = document.getElementById("chart").getContext("2d");
  if (chart) chart.destroy();
  chart = new Chart(ctx, {
    type: "doughnut",
    data: {
      labels: ["Terkonsumsi", "Sisa"],
      datasets: [{
        data: [totalCal, Math.max(remaining, 0)],
        backgroundColor: ["#2563eb", "#e5e7eb"],
        borderWidth: 0
      }]
    },
    options: {
      plugins: { legend: { display: true } },
      animation: { duration: 300 }
    }
  });
}

function deleteFood(i) {
  foods.splice(i, 1);
  updateList();
}

document.getElementById("addFood").addEventListener("click", () => {
  const name = document.getElementById("searchFood").value.toLowerCase();
  const weight = parseFloat(document.getElementById("foodWeight").value);
  if (!foodData[name] || isNaN(weight) || weight <= 0) return alert("Masukkan data valid!");
  const cal = foodData[name].cal * weight / 100;
  const protein = foodData[name].protein * weight / 100;
  foods.push({ name, cal, protein });
  document.getElementById("foodWeight").value = "";
  updateList();
});

document.getElementById("searchFood").addEventListener("input", e => {
  const val = e.target.value.toLowerCase();
  const list = Object.keys(foodData).filter(f => f.includes(val)).slice(0, 15);
  const datalist = document.getElementById("foodList");
  datalist.innerHTML = list.map(f => `<option value="${f}">`).join("");
});

document.getElementById("calNeed").addEventListener("input", e => calNeed = e.target.value);
document.getElementById("goal").addEventListener("change", e => goal = e.target.value);

updateList();
</script>
</body>
</html>
